{{- define "common.corevpa" -}}
{{- if .Values.vpa.enabled -}}

--
apiVersion: autoscaling.k8s.io/v1beta2
kind: VerticalPodAutoscaler
metadata:
  name: {{ template "common.name" . }}
{{- if .Values.global.namespace }}
  namespace: {{ .Values.global.coreNamespace }} 
{{- else }}   
  namespace: {{ .Values.namespace }}
{{- end }}  
spec:
  targetRef:
    apiVersion: "apps/v1"
    kind:       Deployment
    name:      {{ template "common.name" . }}
  updatePolicy:
    updateMode: {{ .Values.vpa.updateMode | quote }}
{{- end -}}
{{- end -}}