# Common Labels
labels:
  app: "epass-chatbot"
  group: "ispirit"
namespace: ispirit

# Ingress Configs
ingress:
  enabled: true
  context: "sms-webhook"
  ip-whitelist: "0.0.0.0/0"
  host: |
    - host: {{ index .Values "global" "moca-domain" }}
  tls: |
      - hosts:
        - {{ index .Values "global" "moca-domain" }}
        secretName: {{ index .Values "global" "moca-domain" }}-tls-certs  
  additionalAnnotations: |
    certmanager.k8s.io/cluster-issuer: {{ index $.Values "cluster-configs" "root-ingress" "cert-issuer" | quote }}  
    nginx.ingress.kubernetes.io/whitelist-source-range: {{ index .Values "ingress" "ip-whitelist" | quote }}      

# Container Configs
image:
  repository: "epass-chatbot"
replicas: "1"
healthChecks:
  enabled: true
  livenessProbePath: "/sms-webhook/health"
  readinessProbePath: "/sms-webhook/health"
tracing-enabled: true
heap: "-Xmx192m -Xms192m"
java-args: ""
sender-id: DOCAEP
error-message-for-server-error: "Due to technical difficulties, we are unable to verify passes right now"
message-epass-create: "Dear <firstName> <lastName>, your COVID e-Pass <token> valid till <validTillDate> has been issued. Pass valid with Govt Id in <validLocations>. To verify pls SMS: VERIFY <token> on 9686454890. Issued under the authority of Secretary, Dept of Consumer Affairs"
message-verify-response: "COVID e-Pass <token> to <firstName> <lastName> is valid till <validTillDate> in <validLocations>. Pass valid with Govt Id only. Issued under Secretary, Dept of Consumer Affairs"


# Additional Container Envs
env: | 
  - name: APP_TIMEZONE
    value: "Asia/Kolkata"       
  - name: SERVER_PORT
    value: "8080"
  - name: TRACER_OPENTRACING_ENABLED
    value: "true"
  - name: KAFKA_CONFIG_BOOTSTRAP_SERVER_CONFIG
    value: {{ index $.Values "cluster-configs" "configmaps" "egov-config" "data" "kafka-brokers" }}
  - name: SPRING_KAFKA_BOOTSTRAP_SERVERS
    value: {{ index $.Values "cluster-configs" "configmaps" "egov-config" "data" "kafka-brokers" }}
  - name: JAEGER_SERVICE_NAME
    value: epass-chatbot
  - name: JAEGER_SAMPLER_TYPE
    value: remote
  - name: JAEGER_AGENT_HOST
    valueFrom:
      fieldRef:
        apiVersion: v1
        fieldPath: status.hostIP
  - name: JAEGER_AGENT_PORT
    value: "6831"
  - name: JAEGER_SAMPLER_MANAGER_HOST_PORT
    value: $(JAEGER_AGENT_HOST):5778
  - name: JAVA_OPTS
    value: {{ index .Values "heap" | quote }}
  - name: KARIX_SENDER_ID
    value: {{ index .Values "sender-id" | quote }}
  - name: ERROR_MESSAGE_FOR_SERVER_ERROR
    value: {{ index .Values "error-message-for-server-error" }}
  - name: MESSAGE_EPASS_CREATE
    value: {{ index .Values "message-epass-create" }}
  - name: MESSAGE_VERIFY_RESPONSE
    value: {{ index .Values "message-verify-response" }}